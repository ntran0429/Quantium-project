"0","#### Calculate Number of customers by LIFESTAGE and PREMIUM_CUSTOMER and create a plot."
"0","# uniqueN is equivalent to length(unique(x))"
"0","customers <- data[, .(CUSTOMERS = uniqueN(LYLTY_CARD_NBR)), .(LIFESTAGE, PREMIUM_CUSTOMER)][order(-CUSTOMERS)]"
"0"," "
"0","p <- ggplot(data = customers) +"
"0","  geom_mosaic(aes(weight = CUSTOMERS, x = product(PREMIUM_CUSTOMER,LIFESTAGE), fill = PREMIUM_CUSTOMER)) +"
"0","  labs(x = ""Lifestage"", y = ""Premium customer flag"", title = ""Proportion of customers"") +"
"0","  theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0",""
"0","p + geom_text(data = ggplot_build(p)$data[[1]], "
"0","              aes(x = (xmin + xmax)/2 , "
"0","                  y = (ymin + ymax)/2, "
"0","                  # .wt refers to the weight variable specified in 'weight' aesthetic of the geom_mosaic() layer"
"0","                  label = as.character(paste(round(.wt/sum(.wt),3)*100,'%'))))"
