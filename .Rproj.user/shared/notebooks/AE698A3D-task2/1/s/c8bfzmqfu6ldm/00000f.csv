"0","####  Create a function to calculate correlation for a measure, looping"
"0","# through each control store."
"0",""
"0",""
"0","# inputTable as a metric table with potential comparison stores,"
"0","# metricCol as the store metric used to calculate correlation on, "
"0","# and storeComparison as the store number of the trial store."
"0",""
"0",""
"0","calculateCorrelation <- function(inputTable, metricCol, storeComparison) {"
"0","  "
"0","  calcCorrTable = data.table(Store1 = numeric(), Store2 = numeric(), corr_measure = numeric())"
"0",""
"0","  storeNumbers <- unique(inputTable[, STORE_NBR])"
"0","  # loop through each store"
"0","  for (i in storeNumbers) { "
"0","      calculatedMeasure = data.table(""Store1"" = storeComparison, "
"0","                                     ""Store2"" = i,"
"0","                                     ""corr_measure"" = cor(inputTable[STORE_NBR == i, eval(metricCol)], "
"0","                                                          inputTable[STORE_NBR == storeComparison, eval(metricCol)]))"
"0","      # fill in the table"
"0","      calcCorrTable <- rbind(calcCorrTable, calculatedMeasure)"
"0","      }"
"0","      return(calcCorrTable)"
"0","  }"
"0",""
